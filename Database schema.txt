Assessment Database Schema

-- CLIENTS TABLE

CREATE TABLE clients
(
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(150) NOT NULL,
    client_code CHAR(6) NOT NULL UNIQUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_client_name (name)
);


-- Contact table

CREATE TABLE contacts
(
    id INT PRIMARY KEY AUTO_INCREMENT,
    first_name VARCHAR(100) NOT NULL,
    last_name VARCHAR(100) NOT NULL,
    email VARCHAR(150) NOT NULL UNIQUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    INDEX idx_contact_name (last_name, first_name)
);

--  CLIENT - CONTACT LINK TABLE

CREATE TABLE client_contact_links
(
    client_id INT NOT NULL,
    contact_id INT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    PRIMARY KEY (client_id, contact_id),

    FOREIGN KEY (client_id) 
        REFERENCES clients(id) 
        ON DELETE CASCADE,

    FOREIGN KEY (contact_id) 
        REFERENCES contacts(id) 
        ON DELETE CASCADE,

    INDEX idx_contact_lookup (contact_id)
);




// Database data insert quries

// Insert clients data
INSERT INTO clients (id, name, client_code) VALUES
(1, 'African Bank', 'ABA001'),
(2, 'CAPITEC', 'CAP002'),
(3, 'FNB', 'FNB003');

// Insert contacts data
INSERT INTO contacts (id, first_name, last_name, email) VALUES
(1, 'Jabu', 'Mamba', 'jabum@gmail.com'),
(2, 'Sinethemba', 'Maya', 'sinethemba@gmail.com'),
(3, 'Zethu', 'Duman', 'zethuduma@gmail.com'),
(4, 'Zozo', 'Bethu', 'zozombethu@gmail.com'),
(5, 'Zingi', 'Zonto', 'zinzing@gmail.com'),
(9, 'Jabu', 'Tiro', 'jabutiro@gmail.com');

// Insert client contact link data
-- African Bank
INSERT INTO client_contact_link (client_id, contact_id) VALUES
(1,1),
(1,2);

-- CAPITEC
INSERT INTO client_contact_link (client_id, contact_id) VALUES
(2,3),
(2,4),
(2,5);

-- FNB
INSERT INTO client_contact_link (client_id, contact_id) VALUES
(3,3),
(3,4),
(3,5),
(3,9);